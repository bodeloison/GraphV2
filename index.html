<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Graphique ARENH â€“ papernest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
      html, body {
        margin: 0;
        padding: 0;
        font-family: 'Inter', sans-serif;
        background-color: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        width: 100%;
        background: white;
        border-radius: 20px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.05);
        padding: 24px 16px;
        transition: all 0.3s ease-in-out;
        animation: fadeIn 0.3s ease-out;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      h1 {
        text-align: center;
        font-size: 24px;
        color: #5a52ff;
        margin-bottom: 20px;
      }

      .values {
        display: flex;
        justify-content: space-around;
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 16px;
        color: #334155;
      }

      .values span {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 12px;
        background-color: #f1f5f9;
      }

      canvas {
        width: 100% !important;
        height: auto !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ðŸ“Š Ã‰volution des valeurs ARENH</h1>
      <div class="values">
        <span>wARENH : <strong id="warenh">--</strong></span>
        <span>woARENH : <strong id="woarenh">--</strong></span>
      </div>
      <canvas id="myChart" aria-label="Graphique des donnÃ©es ARENH" role="img"></canvas>
    </div>

    <script>
      (async () => {
        const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQx6EhytRbWApgeu6Xzrx9rB-ljbk5rmDNb1zTpNA04gPbw5_1J5nsU4iLDymQ0ymGWgc4iPELmseN4/pub?gid=1717395148&single=true&output=csv";

        const response = await fetch(csvUrl);
        const text = await response.text();
        const rows = text.trim().split("\n").slice(1);

        const labels = [];
        const wARENH = [];
        const woARENH = [];

        for (let row of rows) {
          const [date, val1, val2] = row.split(",");
          labels.push(date);
          wARENH.push(+val1);
          woARENH.push(+val2);
        }

        // Met Ã  jour les derniÃ¨res valeurs dans le DOM
        document.getElementById("warenh").textContent = wARENH.at(-1).toFixed(2) + " â‚¬";
        document.getElementById("woarenh").textContent = woARENH.at(-1).toFixed(2) + " â‚¬";

        const ctx = document.getElementById("myChart").getContext("2d");

        const gradient1 = ctx.createLinearGradient(0, 0, 0, 400);
        gradient1.addColorStop(0, "rgba(90, 82, 255, 0.4)");
        gradient1.addColorStop(1, "rgba(90, 82, 255, 0)");

        const gradient2 = ctx.createLinearGradient(0, 0, 0, 400);
        gradient2.addColorStop(0, "rgba(15, 196, 178, 0.4)");
        gradient2.addColorStop(1, "rgba(15, 196, 178, 0)");

        new Chart(ctx, {
          type: "line",
          data: {
            labels: labels,
            datasets: [
              {
                label: "wARENH",
                data: wARENH,
                borderColor: "#5a52ff",
                backgroundColor: gradient1,
                fill: true,
                tension: 0.4,
                pointRadius: 0
              },
              {
                label: "woARENH",
                data: woARENH,
                borderColor: "#0fc4b2",
                backgroundColor: gradient2,
                fill: true,
                tension: 0.4,
                pointRadius: 0
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  font: {
                    size: 14,
                    weight: "600"
                  },
                  color: "#1e293b"
                }
              },
              tooltip: {
                backgroundColor: "#ffffff",
                borderColor: "#e5e7eb",
                borderWidth: 1,
                titleColor: "#1e293b",
                bodyColor: "#475569",
                titleFont: { weight: '700' },
                bodyFont: { weight: '500' }
              }
            },
            scales: {
              y: {
                ticks: {
                  color: "#64748b",
                  callback: (val) => val + " â‚¬"
                },
                grid: {
                  color: "rgba(100,100,100,0.05)"
                }
              },
              x: {
                ticks: {
                  color: "#64748b"
                },
                grid: {
                  display: false
                }
              }
            }
          }
        });
      })();
    </script>
  </body>
</html>


